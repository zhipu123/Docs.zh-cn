---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
title: "缓存数据与 ObjectDataSource (VB) |Microsoft 文档"
author: rick-anderson
description: "缓存可能意味着速度较慢和快速的 Web 应用程序之间的差异。 本教程是 4 的倍数详细一下缓存在 ASP.NET 中的第一个..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/30/2007
ms.topic: article
ms.assetid: 2e56a733-5512-48a6-9276-70a65bbe4d5d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: fa0a0f1f80a407f8f68d5fe081b5b144e2945700
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/10/2017
---
<a name="caching-data-with-the-objectdatasource-vb"></a><span data-ttu-id="8afa5-104">缓存与对象数据源 (VB) 的数据</span><span class="sxs-lookup"><span data-stu-id="8afa5-104">Caching Data with the ObjectDataSource (VB)</span></span>
====================
<span data-ttu-id="8afa5-105">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8afa5-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8afa5-106">[下载示例应用程序](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe)或[下载 PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8afa5-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) or [Download PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span></span>

> <span data-ttu-id="8afa5-107">缓存可能意味着速度较慢和快速的 Web 应用程序之间的差异。</span><span class="sxs-lookup"><span data-stu-id="8afa5-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="8afa5-108">本教程是 4 的倍数详细一下缓存在 ASP.NET 中的第一个。</span><span class="sxs-lookup"><span data-stu-id="8afa5-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="8afa5-109">了解缓存的关键概念以及如何将应用到通过 ObjectDataSource 控件表示层缓存。</span><span class="sxs-lookup"><span data-stu-id="8afa5-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>


## <a name="introduction"></a><span data-ttu-id="8afa5-110">介绍</span><span class="sxs-lookup"><span data-stu-id="8afa5-110">Introduction</span></span>

<span data-ttu-id="8afa5-111">在计算机科学中*缓存*是接受的数据或将占用大量资源，若要获取的信息并将它的副本存储在访问速度更快的位置的过程。</span><span class="sxs-lookup"><span data-stu-id="8afa5-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="8afa5-112">对于数据驱动的应用程序，大型和复杂查询通常使用大多数的应用程序的执行时间。</span><span class="sxs-lookup"><span data-stu-id="8afa5-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="8afa5-113">此类应用程序的性能，然后，通常可以通过将昂贵的数据库查询的结果存储在应用程序的内存改进。</span><span class="sxs-lookup"><span data-stu-id="8afa5-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="8afa5-114">ASP.NET 2.0 提供了各种各样的缓存选项。</span><span class="sxs-lookup"><span data-stu-id="8afa5-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="8afa5-115">可以通过缓存的整个网页或用户控件呈现的 s 标记*输出缓存*。</span><span class="sxs-lookup"><span data-stu-id="8afa5-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="8afa5-116">ObjectDataSource 和 SqlDataSource 控件提供缓存功能以及，从而允许数据缓存的控制级别。</span><span class="sxs-lookup"><span data-stu-id="8afa5-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="8afa5-117">和 ASP.NET s*数据缓存*提供一个丰富的缓存 API，用于以编程方式缓存对象的页开发人员。</span><span class="sxs-lookup"><span data-stu-id="8afa5-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="8afa5-118">本教程中的下一步的三个，我们将检查使用 ObjectDataSource s 缓存功能，以及为数据缓存。</span><span class="sxs-lookup"><span data-stu-id="8afa5-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="8afa5-119">我们将探讨如何缓存在启动应用程序级数据以及如何使缓存的数据保持最新通过使用 SQL 缓存依赖项。</span><span class="sxs-lookup"><span data-stu-id="8afa5-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="8afa5-120">这些教程不了解输出缓存。</span><span class="sxs-lookup"><span data-stu-id="8afa5-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="8afa5-121">在输出缓存了解详细信息，请参阅[ASP.NET 2.0 中的输出缓存](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="8afa5-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="8afa5-122">缓存可以在该体系结构中的任何位置从数据访问层向上通过应用表示层。</span><span class="sxs-lookup"><span data-stu-id="8afa5-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="8afa5-123">在本教程中我们将查看应用到通过 ObjectDataSource 控件表示层缓存。</span><span class="sxs-lookup"><span data-stu-id="8afa5-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="8afa5-124">在下一步教程中我们将检查缓存在业务逻辑层的数据。</span><span class="sxs-lookup"><span data-stu-id="8afa5-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="8afa5-125">密钥缓存概念</span><span class="sxs-lookup"><span data-stu-id="8afa5-125">Key Caching Concepts</span></span>

<span data-ttu-id="8afa5-126">缓存可以极大地提高应用程序 s 整体性能和可伸缩性通过采用将占用大量资源来生成的数据，并将它的副本存储在可以更有效地访问的位置。</span><span class="sxs-lookup"><span data-stu-id="8afa5-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="8afa5-127">因为缓存容纳只是实际的基础数据的副本，它将变得过期，或*陈旧*，如果基础数据发生更改。</span><span class="sxs-lookup"><span data-stu-id="8afa5-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="8afa5-128">为了应对这种情况，页开发人员可以指示缓存项将依据的条件*逐出*从缓存中，使用：</span><span class="sxs-lookup"><span data-stu-id="8afa5-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="8afa5-129">**基于时间的条件**可能将项添加到缓存中用于绝对或滑动持续时间。</span><span class="sxs-lookup"><span data-stu-id="8afa5-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="8afa5-130">例如，页开发人员可能指示持续时间为说，60 秒。</span><span class="sxs-lookup"><span data-stu-id="8afa5-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="8afa5-131">绝对的持续时间，缓存的项将被逐出 60 秒后它已添加到缓存，而不考虑访问频率。</span><span class="sxs-lookup"><span data-stu-id="8afa5-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="8afa5-132">用一个滑动持续时间，缓存的项将被逐出的上次访问后 60 秒。</span><span class="sxs-lookup"><span data-stu-id="8afa5-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="8afa5-133">**基于依赖项的条件**依赖项可以是与时添加到缓存的项相关联。</span><span class="sxs-lookup"><span data-stu-id="8afa5-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="8afa5-134">S 项依赖项发生更改时它是从缓存中逐出。</span><span class="sxs-lookup"><span data-stu-id="8afa5-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="8afa5-135">依赖项可能是文件、 另一个缓存项或两者的组合。</span><span class="sxs-lookup"><span data-stu-id="8afa5-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="8afa5-136">ASP.NET 2.0 还允许 SQL 缓存依赖关系，可让开发人员将项添加到缓存并让它逐出基础数据库数据发生更改时。</span><span class="sxs-lookup"><span data-stu-id="8afa5-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="8afa5-137">我们将检查 SQL 缓存依赖项中即将推出的[使用 SQL 缓存依赖项](using-sql-cache-dependencies-vb.md)教程。</span><span class="sxs-lookup"><span data-stu-id="8afa5-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="8afa5-138">指定的逐出条件，无论缓存中的项可能*清理*满足基于时间的或基于依赖项的条件之前。</span><span class="sxs-lookup"><span data-stu-id="8afa5-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="8afa5-139">如果缓存已达到其容量，则必须先删除现有项，然后才能添加新的。</span><span class="sxs-lookup"><span data-stu-id="8afa5-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="8afa5-140">因此，以编程方式使用缓存数据时它 s 至关重要，你始终假定，则缓存的数据可能不存在。</span><span class="sxs-lookup"><span data-stu-id="8afa5-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="8afa5-141">我们将查看要使用在访问数据时从缓存以编程方式在我们的下一教程中的模式*体系结构中缓存数据*。</span><span class="sxs-lookup"><span data-stu-id="8afa5-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="8afa5-142">缓存提供了一种经济的方法挤压从应用程序的详细性能。</span><span class="sxs-lookup"><span data-stu-id="8afa5-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="8afa5-143">作为[Steven Smith](http://aspadvice.com/blogs/ssmith/)说明了在他的文章[ASP.NET 缓存： 方法和最佳实践](https://msdn.microsoft.com/en-us/library/aa478965.aspx):</span><span class="sxs-lookup"><span data-stu-id="8afa5-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/en-us/library/aa478965.aspx):</span></span>

<span data-ttu-id="8afa5-144">缓存可以获得良好足够性能而不需要大量时间和分析的一种好方法。</span><span class="sxs-lookup"><span data-stu-id="8afa5-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="8afa5-145">内存是比较便宜，因此如果你可以获取所需的缓存的输出，而不是一天或每周尝试优化你的代码或数据库的花费 30 秒的性能，请执行缓存的解决方案 （假定为第二个旧-30 数据是确定），然后移。</span><span class="sxs-lookup"><span data-stu-id="8afa5-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="8afa5-146">最后，较差的设计将可能赶上到你，因此当然，你应尝试正确设计应用程序。</span><span class="sxs-lookup"><span data-stu-id="8afa5-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="8afa5-147">但如果你只需获得良好今天的足够性能，缓存可能是一个极好 [方法]，购买时间重构你的应用程序在以后当必须进行这些操作的时间。</span><span class="sxs-lookup"><span data-stu-id="8afa5-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="8afa5-148">虽然缓存可以提供明显的性能增强功能，它并不适用于在所有情况下，例如，使用经常更新的实时数据，或甚至很快留存陈旧数据是不可接受的应用程序。</span><span class="sxs-lookup"><span data-stu-id="8afa5-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="8afa5-149">但对于大多数应用程序的情况下，应使用缓存。</span><span class="sxs-lookup"><span data-stu-id="8afa5-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="8afa5-150">有关在 ASP.NET 2.0 中缓存的更多背景，请参阅[缓存以提高性能](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx)部分[ASP.NET 2.0 快速入门教程](https://quickstarts.asp.net/QuickStartv20/aspnet/)。</span><span class="sxs-lookup"><span data-stu-id="8afa5-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="8afa5-151">步骤 1： 创建缓存的 Web 页</span><span class="sxs-lookup"><span data-stu-id="8afa5-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="8afa5-152">我们开始我们浏览 ObjectDataSource s 缓存功能之前，让我们来首先花一些时间，我们需要以及本教程的下一步的三个网站项目中创建 ASP.NET 页。</span><span class="sxs-lookup"><span data-stu-id="8afa5-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="8afa5-153">首先，通过添加一个名为的新文件夹`Caching`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="8afa5-154">接下来，添加到该文件夹，并确保将每个包含网页相关联的以下 ASP.NET 页面`Site.master`母版页：</span><span class="sxs-lookup"><span data-stu-id="8afa5-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`


![添加 ASP.NET 页的缓存相关的教程](caching-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="8afa5-156">**图 1**： 添加 ASP.NET 页的缓存相关的教程</span><span class="sxs-lookup"><span data-stu-id="8afa5-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>


<span data-ttu-id="8afa5-157">在其他文件夹中，如`Default.aspx`中`Caching`文件夹将在其部分中列出这些教程。</span><span class="sxs-lookup"><span data-stu-id="8afa5-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="8afa5-158">回想一下，`SectionLevelTutorialListing.ascx`用户控件提供此功能。</span><span class="sxs-lookup"><span data-stu-id="8afa5-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="8afa5-159">因此，此用户将控件添加到`Default.aspx`通过从解决方案资源管理器拖到页面上的设计视图拖动。</span><span class="sxs-lookup"><span data-stu-id="8afa5-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="8afa5-160">[![图 2： 将 SectionLevelTutorialListing.ascx 用户控件添加到 Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="8afa5-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="8afa5-161">**图 2**： 图 2： 添加`SectionLevelTutorialListing.ascx`用户控件`Default.aspx`([单击以查看实际尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="8afa5-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>


<span data-ttu-id="8afa5-162">最后，将这些页面添加到的条目为`Web.sitemap`文件。</span><span class="sxs-lookup"><span data-stu-id="8afa5-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="8afa5-163">具体而言，在处理二进制数据后添加以下标记`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="8afa5-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>


[!code-xml[Main](caching-data-with-the-objectdatasource-vb/samples/sample1.xml)]

<span data-ttu-id="8afa5-164">在更新后`Web.sitemap`，花些时间查看通过浏览器网站的教程。</span><span class="sxs-lookup"><span data-stu-id="8afa5-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="8afa5-165">现在，在左侧菜单在缓存教程包括项。</span><span class="sxs-lookup"><span data-stu-id="8afa5-165">The menu on the left now includes items for the caching tutorials.</span></span>


![站点图现在包括缓存的教程的条目](caching-data-with-the-objectdatasource-vb/_static/image5.png)

<span data-ttu-id="8afa5-167">**图 3**： 站点图现在包括缓存的教程的条目</span><span class="sxs-lookup"><span data-stu-id="8afa5-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>


## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="8afa5-168">步骤 2： 在 Web 页上显示产品的列表</span><span class="sxs-lookup"><span data-stu-id="8afa5-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="8afa5-169">本教程将探讨如何使用 ObjectDataSource 控件 s 内置缓存功能。</span><span class="sxs-lookup"><span data-stu-id="8afa5-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="8afa5-170">我们可以看看这些功能之前，不过，我们首先需要页后，可以从工作。</span><span class="sxs-lookup"><span data-stu-id="8afa5-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="8afa5-171">允许 s 创建一个网页，使用列出产品信息检索从 ObjectDataSource GridView`ProductsBLL`类。</span><span class="sxs-lookup"><span data-stu-id="8afa5-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="8afa5-172">首先打开`ObjectDataSource.aspx`页面`Caching`文件夹。</span><span class="sxs-lookup"><span data-stu-id="8afa5-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="8afa5-173">从工具箱拖动到设计器中拖动 GridView，设置其`ID`属性`Products`，和从其智能标记上，选择要绑定到一个名为的新 ObjectDataSource 控件`ProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="8afa5-174">配置要使用 ObjectDataSource`ProductsBLL`类。</span><span class="sxs-lookup"><span data-stu-id="8afa5-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>


<span data-ttu-id="8afa5-175">[![配置对象数据源以使用 ProductsBLL 类](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="8afa5-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span></span>

<span data-ttu-id="8afa5-176">**图 4**： 配置使用 ObjectDataSource`ProductsBLL`类 ([单击以查看实际尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="8afa5-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span></span>


<span data-ttu-id="8afa5-177">有关此页上，让我们来创建可编辑的 GridView，以便我们可以检查在 ObjectDataSource 中缓存数据修改通过 GridView 的界面时，会发生什么情况。</span><span class="sxs-lookup"><span data-stu-id="8afa5-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="8afa5-178">在选择选项卡中设置为其默认值，将下拉列表`GetProducts()`，但更改到更新选项卡中的选定的项`UpdateProduct`接受的重载`productName`， `unitPrice`，和`productID`作为其输入参数。</span><span class="sxs-lookup"><span data-stu-id="8afa5-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>


<span data-ttu-id="8afa5-179">[![将更新选项卡的下拉列表设置为相应 UpdateProduct 重载](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="8afa5-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="8afa5-180">**图 5**： 将更新选项卡的下拉列表设置为适合`UpdateProduct`重载 ([单击以查看实际尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="8afa5-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span></span>


<span data-ttu-id="8afa5-181">最后，将下拉列表设置到 （无） 插入和删除选项卡中，单击完成。</span><span class="sxs-lookup"><span data-stu-id="8afa5-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="8afa5-182">Visual Studio 将在完成配置数据源向导，请设置 ObjectDataSource s`OldValuesParameterFormatString`属性`original_{0}`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="8afa5-183">中所述[概述的插入、 更新和删除数据](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)教程中，此属性需要从声明性语法中删除或重新设置为其默认值， `{0}`，以便我们更新工作流保存到继续执行而未出现错误。</span><span class="sxs-lookup"><span data-stu-id="8afa5-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="8afa5-184">此外，在向导完成 Visual Studio 将字段添加到 GridView 为每个产品数据字段。</span><span class="sxs-lookup"><span data-stu-id="8afa5-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="8afa5-185">删除所有但`ProductName`， `CategoryName`，和`UnitPrice`BoundFields。</span><span class="sxs-lookup"><span data-stu-id="8afa5-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="8afa5-186">接下来，更新`HeaderText`的每个产品、 类别和价格，到这些 BoundFields 属性分别。</span><span class="sxs-lookup"><span data-stu-id="8afa5-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="8afa5-187">由于`ProductName`字段是必填，将 BoundField 转换转换为 TemplateField 并添加到 RequiredFieldValidator `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="8afa5-188">同样，将转换`UnitPrice`转换为 TemplateField BoundField 和添加 CompareValidator 以确保用户输入的值为有效的货币值 s 大于或等于零。</span><span class="sxs-lookup"><span data-stu-id="8afa5-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="8afa5-189">除了这些修改，请尝试执行任何美观的更改，如右对齐`UnitPrice`值，或指定的格式设置`UnitPrice`其只读和编辑接口中的文本。</span><span class="sxs-lookup"><span data-stu-id="8afa5-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="8afa5-190">使 GridView 通过检查 GridView s 智能标记中的启用编辑复选框可编辑。</span><span class="sxs-lookup"><span data-stu-id="8afa5-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="8afa5-191">此外请检查启用分页和启用排序复选框。</span><span class="sxs-lookup"><span data-stu-id="8afa5-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="8afa5-192">需要评审如何自定义 GridView s 编辑界面？</span><span class="sxs-lookup"><span data-stu-id="8afa5-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="8afa5-193">如果是这样，回头参考[自定义的数据修改界面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)教程。</span><span class="sxs-lookup"><span data-stu-id="8afa5-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>


<span data-ttu-id="8afa5-194">[![用于编辑、 排序和分页启用 GridView 支持](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="8afa5-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span></span>

<span data-ttu-id="8afa5-195">**图 6**： 启用对编辑，排序和分页的 GridView 支持 ([单击以查看实际尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="8afa5-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span></span>


<span data-ttu-id="8afa5-196">进行这些 GridView 修改后, 的 GridView 和 ObjectDataSource s 声明性标记应看起来类似于以下：</span><span class="sxs-lookup"><span data-stu-id="8afa5-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](caching-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="8afa5-197">如图 7 所示，可编辑的 GridView 将列出名称、 类别和每个数据库中的产品的价格。</span><span class="sxs-lookup"><span data-stu-id="8afa5-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="8afa5-198">花一些时间来测试页的功能排序结果中，逐页查看它们，并编辑记录。</span><span class="sxs-lookup"><span data-stu-id="8afa5-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>


<span data-ttu-id="8afa5-199">[![每个产品名称、 类别和价格被列入 Sortable、 Pageable、 可编辑的 GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="8afa5-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="8afa5-200">**图 7**： 每个产品的名称、 类别和价格被列入 Sortable、 Pageable、 可编辑的 GridView ([单击以查看实际尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="8afa5-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span></span>


## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="8afa5-201">步骤 3： 检查时 ObjectDataSource 是请求数据</span><span class="sxs-lookup"><span data-stu-id="8afa5-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="8afa5-202">`Products` GridView 检索要显示通过调用其数据`Select`方法`ProductsDataSource`对象数据源。</span><span class="sxs-lookup"><span data-stu-id="8afa5-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="8afa5-203">此对象数据源创建的业务逻辑层的实例`ProductsBLL`类并调用其`GetProducts()`方法，后者反过来调用数据访问层 s `ProductsTableAdapter` s`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="8afa5-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="8afa5-204">DAL 方法连接到 Northwind 数据库，并发出配置`SELECT`查询。</span><span class="sxs-lookup"><span data-stu-id="8afa5-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="8afa5-205">此数据随后会返回与 DAL，它打包在`NorthwindDataTable`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="8afa5-206">DataTable 对象就会归还 BLL，将其返回给对象数据源，将其返回给 GridView。</span><span class="sxs-lookup"><span data-stu-id="8afa5-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="8afa5-207">然后创建 GridView`GridViewRow`每个对象`DataRow`位于 DataTable，和每个`GridViewRow`最终呈现之后，可返回到客户端的访问者 s 浏览器上显示的 HTML。</span><span class="sxs-lookup"><span data-stu-id="8afa5-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="8afa5-208">这一序列的事件发生 GridView 需要绑定到其基础数据的每个时间。</span><span class="sxs-lookup"><span data-stu-id="8afa5-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="8afa5-209">当首次访问页上，当一个各页之间移动数据的另一个，排序 GridView，或修改通过其内置编辑或删除接口的 GridView 的数据时，将发生这种情况。</span><span class="sxs-lookup"><span data-stu-id="8afa5-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="8afa5-210">如果禁用 GridView 的视图状态，则将在每个回发时以及重新绑定 GridView。</span><span class="sxs-lookup"><span data-stu-id="8afa5-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="8afa5-211">GridView 可以还显式重新绑定到其数据通过调用其`DataBind()`方法。</span><span class="sxs-lookup"><span data-stu-id="8afa5-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="8afa5-212">为了充分认识与其从数据库检索的数据的频率，让我们来显示一条指示正在重新检索数据时消息。</span><span class="sxs-lookup"><span data-stu-id="8afa5-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="8afa5-213">添加名为 GridView 上方的一个标签 Web 控件`ODSEvents`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="8afa5-214">清除其`Text`属性并设置其`EnableViewState`属性`False`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-214">Clear out its `Text` property and set its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="8afa5-215">下方标签，添加按钮 Web 控件并设置其`Text`回发到的属性。</span><span class="sxs-lookup"><span data-stu-id="8afa5-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>


<span data-ttu-id="8afa5-216">[![将标签和按钮添加到页面上方 GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="8afa5-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span></span>

<span data-ttu-id="8afa5-217">**图 8**： 将标签和按钮添加到 GridView 页上面 ([单击以查看实际尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="8afa5-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span></span>


<span data-ttu-id="8afa5-218">在数据访问工作流，ObjectDataSource 的`Selecting`之前创建的基础对象的事件触发和其配置的方法调用。</span><span class="sxs-lookup"><span data-stu-id="8afa5-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="8afa5-219">创建此事件的事件处理，并添加以下代码：</span><span class="sxs-lookup"><span data-stu-id="8afa5-219">Create an event handler for this event and add the following code:</span></span>


[!code-vb[Main](caching-data-with-the-objectdatasource-vb/samples/sample3.vb)]

<span data-ttu-id="8afa5-220">ObjectDataSource 发出请求时，数据体系结构每次该标签将显示文本选择事件激发。</span><span class="sxs-lookup"><span data-stu-id="8afa5-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="8afa5-221">访问此页面的浏览器中。</span><span class="sxs-lookup"><span data-stu-id="8afa5-221">Visit this page in a browser.</span></span> <span data-ttu-id="8afa5-222">当首次访问页时，将显示文本选择事件激发。</span><span class="sxs-lookup"><span data-stu-id="8afa5-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="8afa5-223">单击回发的按钮，并记下的文本会消失 (假设 GridView s`EnableViewState`属性设置为`True`，默认值)。</span><span class="sxs-lookup"><span data-stu-id="8afa5-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `True`, the default).</span></span> <span data-ttu-id="8afa5-224">这是因为在回发时，从其视图状态重构 GridView，因此，不会变为其数据 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="8afa5-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="8afa5-225">排序、 分页，或编辑数据，但是，导致 GridView 重新绑定到数据源，并因此选择事件激发文本随即再次显示。</span><span class="sxs-lookup"><span data-stu-id="8afa5-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>


<span data-ttu-id="8afa5-226">[![每当 GridView 其数据源重新绑定，显示选择事件激发](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="8afa5-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="8afa5-227">**图 9**： 每当 GridView 重新绑定到其数据源，将显示选择事件激发 ([单击以查看实际尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="8afa5-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span></span>


<span data-ttu-id="8afa5-228">[![单击回发按钮会导致 GridView 必须从其视图状态重新构建](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="8afa5-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span></span>

<span data-ttu-id="8afa5-229">**图 10**： 单击回发按钮会导致 GridView 以从其视图状态进行重建 ([单击以查看实际尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="8afa5-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span></span>


<span data-ttu-id="8afa5-230">这可能看起来浪费检索每次通过分页或排序数据的数据库数据。</span><span class="sxs-lookup"><span data-stu-id="8afa5-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="8afa5-231">毕竟，因为我们重新使用默认分页，ObjectDataSource 已检索的所有记录时显示的第一页。</span><span class="sxs-lookup"><span data-stu-id="8afa5-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="8afa5-232">即使 GridView 不提供排序和分页支持，每个页面首次访问的任何用户 （以及每次回发，如果禁用了视图状态） 的时间必须检索的数据从数据库。</span><span class="sxs-lookup"><span data-stu-id="8afa5-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="8afa5-233">但如果 GridView 向所有用户显示相同的数据，这些额外数据库请求是多余的。</span><span class="sxs-lookup"><span data-stu-id="8afa5-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="8afa5-234">为什么不缓存从返回的结果`GetProducts()`方法和绑定到 GridView 缓存结果？</span><span class="sxs-lookup"><span data-stu-id="8afa5-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="8afa5-235">步骤 4： 缓存使用对象数据源的数据</span><span class="sxs-lookup"><span data-stu-id="8afa5-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="8afa5-236">通过只需设置的几个属性，可以将对象数据源配置为自动缓存其 ASP.NET 数据缓存中检索到的数据。</span><span class="sxs-lookup"><span data-stu-id="8afa5-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="8afa5-237">以下列表总结了 ObjectDataSource 的缓存相关的属性：</span><span class="sxs-lookup"><span data-stu-id="8afa5-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="8afa5-238">[EnableCaching](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx)必须设置为`True`若要启用缓存。</span><span class="sxs-lookup"><span data-stu-id="8afa5-238">[EnableCaching](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `True` to enable caching.</span></span> <span data-ttu-id="8afa5-239">默认值为 `False`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-239">The default is `False`.</span></span>
- <span data-ttu-id="8afa5-240">[CacheDuration](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx)的时间，以秒为单位，缓存数据量。</span><span class="sxs-lookup"><span data-stu-id="8afa5-240">[CacheDuration](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="8afa5-241">默认值为 0。</span><span class="sxs-lookup"><span data-stu-id="8afa5-241">The default is 0.</span></span> <span data-ttu-id="8afa5-242">ObjectDataSource 仅缓存数据，如果`EnableCaching`是`True`和`CacheDuration`设置为值大于零。</span><span class="sxs-lookup"><span data-stu-id="8afa5-242">The ObjectDataSource will only cache data if `EnableCaching` is `True` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="8afa5-243">[CacheExpirationPolicy](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx)可以将设置为`Absolute`或`Sliding`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-243">[CacheExpirationPolicy](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="8afa5-244">如果`Absolute`，ObjectDataSource 缓存为其检索到的数据`CacheDuration`秒; 如果`Sliding`的数据过期仅后未存取过`CacheDuration`秒。</span><span class="sxs-lookup"><span data-stu-id="8afa5-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="8afa5-245">默认值为 `Absolute`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="8afa5-246">[CacheKeyDependency](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx)使用此属性与现有的缓存依赖项关联的 ObjectDataSource 的缓存项。</span><span class="sxs-lookup"><span data-stu-id="8afa5-246">[CacheKeyDependency](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="8afa5-247">ObjectDataSource 的数据条目可以被提前逐出从缓存过期及其关联`CacheKeyDependency`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="8afa5-248">此属性通常用于将 SQL 缓存依赖项与 ObjectDataSource 的缓存相关联，主题我们将探讨在将来[使用 SQL 缓存依赖项](using-sql-cache-dependencies-vb.md)教程。</span><span class="sxs-lookup"><span data-stu-id="8afa5-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="8afa5-249">让我们来配置`ProductsDataSource`ObjectDataSource 30 秒内对绝对刻度缓存其数据。</span><span class="sxs-lookup"><span data-stu-id="8afa5-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="8afa5-250">设置 ObjectDataSource s`EnableCaching`属性`True`及其`CacheDuration`为 30 的属性。</span><span class="sxs-lookup"><span data-stu-id="8afa5-250">Set the ObjectDataSource s `EnableCaching` property to `True` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="8afa5-251">保留`CacheExpirationPolicy`属性设置为其默认值， `Absolute`。</span><span class="sxs-lookup"><span data-stu-id="8afa5-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>


<span data-ttu-id="8afa5-252">[![配置对象数据源在 30 秒内缓存其数据](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="8afa5-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="8afa5-253">**图 11**： 配置对象数据源在 30 秒内缓存其数据 ([单击以查看实际尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="8afa5-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span></span>


<span data-ttu-id="8afa5-254">保存所做的更改并重新访问此页在浏览器。</span><span class="sxs-lookup"><span data-stu-id="8afa5-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="8afa5-255">选择触发的事件文本将显示当你首次访问页上，为最初的数据不在缓存中。</span><span class="sxs-lookup"><span data-stu-id="8afa5-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="8afa5-256">而不是后续回发通过单击回发的按钮，排序，触发的分页，或单击编辑或取消按钮*不*重新显示选择事件激发文本。</span><span class="sxs-lookup"><span data-stu-id="8afa5-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="8afa5-257">这是因为`Selecting`事件才会触发时 ObjectDataSource 获取其数据从其基础的对象;`Selecting`如果从数据缓存中提取数据，不会不会触发事件。</span><span class="sxs-lookup"><span data-stu-id="8afa5-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="8afa5-258">30 秒后，将从缓存逐出数据。</span><span class="sxs-lookup"><span data-stu-id="8afa5-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="8afa5-259">此外可从缓存逐出数据 ObjectDataSource s `Insert`， `Update`，或`Delete`调用方法。</span><span class="sxs-lookup"><span data-stu-id="8afa5-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="8afa5-260">因此，过了 30 秒的更新按钮单击后，排序、 分页，或单击编辑或取消按钮将导致 ObjectDataSource 若要从其基础对象中获取其数据后，显示选择事件激发文本时`Selecting`事件激发。</span><span class="sxs-lookup"><span data-stu-id="8afa5-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="8afa5-261">这些返回的结果放回数据缓存中。</span><span class="sxs-lookup"><span data-stu-id="8afa5-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="8afa5-262">如果经常查看选择激发事件文本，即使你预期对象数据源以使用缓存的数据，它可能由于内存约束。</span><span class="sxs-lookup"><span data-stu-id="8afa5-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="8afa5-263">如果没有足够的可用内存，通过对象数据源添加到缓存的数据可能已清理。</span><span class="sxs-lookup"><span data-stu-id="8afa5-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="8afa5-264">如果 ObjectDataSource 不 t 看上去正确缓存的数据或仅缓存数据将个别情况下，关闭一些应用程序以释放内存，然后重试。</span><span class="sxs-lookup"><span data-stu-id="8afa5-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>


<span data-ttu-id="8afa5-265">图 12 显示了缓存工作流的 ObjectDataSource s。</span><span class="sxs-lookup"><span data-stu-id="8afa5-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="8afa5-266">选择事件激发时文本显示在屏幕上，这是因为数据未在缓存中且必须从基础对象中检索。</span><span class="sxs-lookup"><span data-stu-id="8afa5-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="8afa5-267">此文本时缺失，但是，它 s 因为从缓存的数据。</span><span class="sxs-lookup"><span data-stu-id="8afa5-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="8afa5-268">当从缓存返回的数据执行不需要调用的基础对象和任何数据库查询，因此，该处 s。</span><span class="sxs-lookup"><span data-stu-id="8afa5-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>


![ObjectDataSource 存储和检索其数据从数据缓存](caching-data-with-the-objectdatasource-vb/_static/image30.png)

<span data-ttu-id="8afa5-270">**图 12**: ObjectDataSource 存储和从数据缓存中检索其数据</span><span class="sxs-lookup"><span data-stu-id="8afa5-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>


<span data-ttu-id="8afa5-271">每个 ASP.NET 应用程序实例在所有页和访问者之间共享该 s 自己数据缓存。</span><span class="sxs-lookup"><span data-stu-id="8afa5-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="8afa5-272">这意味着跨所有用户访问页同样共享数据缓存内存储的对象数据源的数据。</span><span class="sxs-lookup"><span data-stu-id="8afa5-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="8afa5-273">若要验证这一点，打开`ObjectDataSource.aspx`在浏览器中的页。</span><span class="sxs-lookup"><span data-stu-id="8afa5-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="8afa5-274">当第一次访问该页面，选择激发事件文本将显示 （假设由以前的测试添加到缓存的数据已，到目前为止，退出）。</span><span class="sxs-lookup"><span data-stu-id="8afa5-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="8afa5-275">打开第二个浏览器实例并复制和粘贴到第二个第一个浏览器实例的 URL。</span><span class="sxs-lookup"><span data-stu-id="8afa5-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="8afa5-276">在第二个浏览器实例中，选择激发的事件文本未显示，因为它使用相同的 s 缓存与第一个的数据。</span><span class="sxs-lookup"><span data-stu-id="8afa5-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="8afa5-277">ObjectDataSource 在其检索到的数据插入到缓存时，使用包含的缓存密钥值：`CacheDuration`和`CacheExpirationPolicy`属性值; 对象数据源，指定正在使用的基础业务对象的类型通过[`TypeName`属性](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.typename.aspx)(`ProductsBLL`，在此示例中); 的值`SelectMethod`属性的名称和值中的参数的`SelectParameters`集合; 以及其的值`StartRowIndex`和`MaximumRows`属性，在实现时使用[自定义分页](../paging-and-sorting/paging-and-sorting-report-data-vb.md)。</span><span class="sxs-lookup"><span data-stu-id="8afa5-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span></span>

<span data-ttu-id="8afa5-278">为这些属性的组合创建的缓存密钥值可确保唯一缓存项，因为这些值发生变化。</span><span class="sxs-lookup"><span data-stu-id="8afa5-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="8afa5-279">例如，在过去教程我们已了解了使用`ProductsBLL`类的`GetProductsByCategoryID(categoryID)`，这将返回为指定类别的所有产品。</span><span class="sxs-lookup"><span data-stu-id="8afa5-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="8afa5-280">一个用户可能要到页并查看饮料具有`CategoryID`为 1。</span><span class="sxs-lookup"><span data-stu-id="8afa5-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="8afa5-281">如果 ObjectDataSource 缓存而不考虑其结果`SelectParameters`值，在另一个用户提供到页以查看调味品时饮料产品已在缓存中时，他们 d 看到缓存的饮料产品而不是调味品。</span><span class="sxs-lookup"><span data-stu-id="8afa5-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="8afa5-282">通过按这些属性进行区分的缓存密钥，其中包括的值`SelectParameters`，ObjectDataSource 维护计算的 beverages 和调味品的单独的缓存项。</span><span class="sxs-lookup"><span data-stu-id="8afa5-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="8afa5-283">陈旧数据问题</span><span class="sxs-lookup"><span data-stu-id="8afa5-283">Stale Data Concerns</span></span>

<span data-ttu-id="8afa5-284">ObjectDataSource 自动逐出从缓存时的任何一个其项其`Insert`， `Update`，或`Delete`调用方法。</span><span class="sxs-lookup"><span data-stu-id="8afa5-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="8afa5-285">这有助于保护计算机免受陈旧数据完成的页修改的数据时清除缓存条目。</span><span class="sxs-lookup"><span data-stu-id="8afa5-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="8afa5-286">但是，它有可能使用缓存来仍显示过时的数据对象数据源。</span><span class="sxs-lookup"><span data-stu-id="8afa5-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="8afa5-287">在最简单的情况下，它可能是由于直接在数据库内更改的数据。</span><span class="sxs-lookup"><span data-stu-id="8afa5-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="8afa5-288">可能是数据库管理员只需运行修改的某些数据库中记录的脚本。</span><span class="sxs-lookup"><span data-stu-id="8afa5-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="8afa5-289">这种情况下也可能更难以捉摸的方式展开。</span><span class="sxs-lookup"><span data-stu-id="8afa5-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="8afa5-290">尽管 ObjectDataSource 逐出缓存中的其项目数据修改方法之一调用时，删除的缓存的项是属性值的 ObjectDataSource s 特定组合 (`CacheDuration`， `TypeName`， `SelectMethod`，依此类推）。</span><span class="sxs-lookup"><span data-stu-id="8afa5-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="8afa5-291">如果必须使用不同的两个 ObjectDataSources`SelectMethods`或`SelectParameters`，但仍可以中更新同一数据，然后一个 ObjectDataSource 可能更新的行，并使其自己的缓存条目，但相应的行无效的第二个对象数据源仍将提供从已缓存。</span><span class="sxs-lookup"><span data-stu-id="8afa5-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="8afa5-292">我建议你创建页面来展示此功能。</span><span class="sxs-lookup"><span data-stu-id="8afa5-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="8afa5-293">创建显示可编辑的 GridView，从 ObjectDataSource 使用缓存并配置为从获取数据提取其数据的页`ProductsBLL`类的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="8afa5-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="8afa5-294">添加另一个可编辑 GridView 和 ObjectDataSource 此页 （或另一个），但可用于此第二个 ObjectDataSource 让它使用`GetProductsByCategoryID(categoryID)`方法。</span><span class="sxs-lookup"><span data-stu-id="8afa5-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="8afa5-295">由于两个 ObjectDataSources`SelectMethod`属性不同，它们将每个具有它们自己的缓存的值。</span><span class="sxs-lookup"><span data-stu-id="8afa5-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="8afa5-296">如果你编辑一个网格中的产品下一次将数据返回到其他网格绑定 （由分页、 排序和等），将仍为旧的、 缓存数据提供服务并不反映已从其他网格所做的更改。</span><span class="sxs-lookup"><span data-stu-id="8afa5-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="8afa5-297">如果您愿意为陈旧的数据，可能和数据的新鲜度是重要的方案使用短满简单地说，只能使用基于时间的满。</span><span class="sxs-lookup"><span data-stu-id="8afa5-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="8afa5-298">如果过时的数据不是可接受的则放弃缓存或使用 SQL 缓存依赖项 (假设它为数据库数据所缓存)。</span><span class="sxs-lookup"><span data-stu-id="8afa5-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="8afa5-299">在将来的教程中，我们将探讨 SQL 缓存依赖项。</span><span class="sxs-lookup"><span data-stu-id="8afa5-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="8afa5-300">摘要</span><span class="sxs-lookup"><span data-stu-id="8afa5-300">Summary</span></span>

<span data-ttu-id="8afa5-301">在本教程中，我们将探讨 ObjectDataSource s 内置缓存功能。</span><span class="sxs-lookup"><span data-stu-id="8afa5-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="8afa5-302">通过只需设置的几个属性，我们可以指示 ObjectDataSource 缓存返回从指定的结果`SelectMethod`到 ASP.NET 数据缓存。</span><span class="sxs-lookup"><span data-stu-id="8afa5-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="8afa5-303">`CacheDuration`和`CacheExpirationPolicy`属性指示缓存项的持续时间以及它是否是绝对或相对过期机制。</span><span class="sxs-lookup"><span data-stu-id="8afa5-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="8afa5-304">`CacheKeyDependency`属性将与现有的缓存依赖项关联的所有对象数据源的缓存条目。</span><span class="sxs-lookup"><span data-stu-id="8afa5-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="8afa5-305">这可用来收回 ObjectDataSource 的项目从缓存，然后基于时间的过期为止，并通常用于 SQL 缓存依赖项。</span><span class="sxs-lookup"><span data-stu-id="8afa5-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="8afa5-306">由于 ObjectDataSource 只需缓存数据缓存到其值，我们无法以编程方式复制 ObjectDataSource s 内置功能。</span><span class="sxs-lookup"><span data-stu-id="8afa5-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="8afa5-307">它不是 t 意义执行此操作在表示层上，因为 ObjectDataSource 提供在初始状态下，此功能，但我们可以在体系结构的一个单独的层中实现缓存功能。</span><span class="sxs-lookup"><span data-stu-id="8afa5-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="8afa5-308">若要执行此操作，我们将需要重复 ObjectDataSource 所使用的相同逻辑。</span><span class="sxs-lookup"><span data-stu-id="8afa5-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="8afa5-309">我们将探讨如何以编程方式使用数据缓存从体系结构中，在我们的下一教程。</span><span class="sxs-lookup"><span data-stu-id="8afa5-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="8afa5-310">尽情享受编程 ！</span><span class="sxs-lookup"><span data-stu-id="8afa5-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="8afa5-311">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="8afa5-311">Further Reading</span></span>

<span data-ttu-id="8afa5-312">在本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="8afa5-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="8afa5-313">ASP.NET 缓存： 方法和最佳实践</span><span class="sxs-lookup"><span data-stu-id="8afa5-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/en-us/library/aa478965.aspx)
- [<span data-ttu-id="8afa5-314">.NET Framework 应用程序的缓存体系结构指南</span><span class="sxs-lookup"><span data-stu-id="8afa5-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/en-us/library/ee817645.aspx)
- [<span data-ttu-id="8afa5-315">在 ASP.NET 2.0 中的输出缓存</span><span class="sxs-lookup"><span data-stu-id="8afa5-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="8afa5-316">关于作者</span><span class="sxs-lookup"><span data-stu-id="8afa5-316">About the Author</span></span>

<span data-ttu-id="8afa5-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七个 ASP/ASP.NET 书籍和的创始人[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年使用与 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="8afa5-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8afa5-318">Scott 的作用是作为独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="8afa5-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8afa5-319">最新书籍是[ *Sam 教授自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="8afa5-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8afa5-320">他可以达到在[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或通过他的博客，其中可以找到在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="8afa5-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8afa5-321">特别感谢</span><span class="sxs-lookup"><span data-stu-id="8afa5-321">Special Thanks To</span></span>

<span data-ttu-id="8afa5-322">本教程系列已由许多有用的审阅者评审。</span><span class="sxs-lookup"><span data-stu-id="8afa5-322">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8afa5-323">本教程中的前导审阅者已 Teresa 墨。</span><span class="sxs-lookup"><span data-stu-id="8afa5-323">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="8afa5-324">对感兴趣查看我即将到来的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="8afa5-324">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8afa5-325">如果是这样，删除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8afa5-325">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="8afa5-326">[上一页](using-sql-cache-dependencies-cs.md)
[下一页](caching-data-in-the-architecture-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8afa5-326">[Previous](using-sql-cache-dependencies-cs.md)
[Next](caching-data-in-the-architecture-vb.md)</span></span>
